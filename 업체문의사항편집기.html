<!DOCTYPE html>
 <html lang="ko">
 <head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Excel 데이터 변환기</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- 기존 xlsx-js-style 라이브러리는 파일 '읽기' 및 '미리보기'용으로 유지 -->
  <script
   src="https://unpkg.com/xlsx-js-style@1.2.0/dist/xlsx.bundle.js"
   onerror="this.onerror=null; this.src='https://cdn.jsdelivr.net/npm/xlsx-js-style@1.2.0/dist/xlsx.bundle.min.js'">
  </script>
  <!-- 새로운 ExcelJS 라이브러리를 파일 '쓰기' 및 '틀 고정' 기능용으로 추가 -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/exceljs/4.3.0/exceljs.min.js"></script>

  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet"/>
  <style>
   body { font-family: 'Inter', sans-serif; }
   .preview-table { border-collapse: collapse; width: 100%; font-size: .8rem; }
   .preview-table th, .preview-table td {
    border: 1px solid #e2e8f0; padding: .375rem .5rem; text-align: left;
    white-space: nowrap; min-width: 20px;
   }
   .preview-table th { background: #f8fafc; font-weight: 600; }
   .selectable:hover { background: #f0f9ff; cursor: pointer; }
   .highlighted { background: #bae6fd !important; }
   #preview-container {
     max-height: 600px;
     overflow-y: auto;
   }
   #prompt-area { display: none; margin-bottom: .5rem; padding: .75rem; background: #e0f2fe;
    border-left: 4px solid #3b82f6; color: #0369a1; border-radius: .375rem; }
  </style>
 </head>
 <body class="bg-slate-50 text-slate-800">
  <div class="container mx-auto p-4 max-w-4xl space-y-6">
   <header class="text-center mb-4">
    <h1 class="text-2xl font-bold">거래처 문의사항 엑셀 내용 변환</h1>
    <p class="text-slate-600">엑셀 파일 업로드 후 지정된 형식으로 변환합니다.</p>
   </header>

   <div class="mb-4">
    <label for="inquiry-type-select" class="block mb-1 font-medium">문의 유형 선택 (필수)</label>
    <select id="inquiry-type-select" class="w-full p-2 border rounded bg-white cursor-pointer">
     <option value="" disabled selected>-- 유형을 선택하세요 --</option>
     <option value="매출처">매출처</option>
     <option value="매입처">매입처</option>
     <option value="확인사항">확인사항</option>
    </select>
   </div>

   <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
    <div>
     <label class="block mb-1 font-medium">차변제목변경</label>
     <input id="debit-label" type="text"
      placeholder="예: 매출처 - 세금계산서발행(or 환불출금)"
      class="w-full p-2 border rounded"/>
    </div>
    <div class="space-y-1 text-sm text-slate-600">
     <p class="font-semibold">차변 설명 예시:</p>
     <ul class="list-disc list-inside">
      <li>매출처 – 세금계산서발행(or 환불출금)</li>
      <li>매입처 – 출금(or 매출상계)</li>
      <li>확인사항 – 통장 출금내역</li>
     </ul>
    </div>

    <div>
     <label class="block mb-1 font-medium">대변제목변경</label>
     <input id="credit-label" type="text"
      placeholder="예: 매출처 - 입금(or 매입상계)"
      class="w-full p-2 border rounded"/>
    </div>
    <div class="space-y-1 text-sm text-slate-600">
     <p class="font-semibold">대변 설명 예시:</p>
     <ul class="list-disc list-inside">
      <li>매출처 – 입금(or 매입상계)</li>
      <li>매입처 – 세금계산서수취(or 환불입금)</li>
      <li>확인사항 – 통장 입금내역</li>
     </ul>
    </div>
   </div>

   <div id="option-container" class="mb-4">
    <label for="option-select" class="block mb-1 font-medium">업체에게 회신방법 예시 제공여부</label>
    <select id="option-select"
     class="w-full p-2 border rounded bg-white cursor-pointer">
     <option value="none">기재하지 않음</option>
     <option value="1">매출처</option>
     <option value="2">매입처</option>
     <option value="3">확인사항</option>
    </select>
   </div>

   <div id="option-detail"
    class="mb-6 p-4 bg-blue-50 border-l-4 border-blue-400 text-sm text-blue-800 hidden">
   </div>

   <div>
    <label for="file-input"
     class="flex items-center justify-center h-40 border-2 border-dashed rounded bg-white cursor-pointer hover:bg-slate-50 transition">
     <span class="text-slate-500">클릭하여 XLSX/XLS 파일 업로드</span>
     <input id="file-input" type="file" accept=".xlsx,.xls" class="hidden"/>
    </label>
    <p id="file-name" class="mt-2 text-sm text-slate-500"></p>
   </div>

   <div id="preview-section" class="hidden space-y-2">
    <div id="prompt-area"><span id="prompt-text"></span></div>
    <button id="edit-btn" class="px-4 py-2 bg-blue-600 text-white rounded disabled:opacity-50" disabled>
     편집 시작
    </button>
    <div id="preview-container" class="overflow-x-auto border rounded bg-white"></div>
   </div>

   <div id="download-section" class="hidden text-center">
    <a id="download-btn" href="#" class="px-6 py-3 bg-green-600 text-white rounded">
     엑셀 다운로드
    </a>
   </div>
  </div>
  <script>
   // --- 기존 라이브러리 체크 함수 ---
   function checkXLSX() {
    if (typeof XLSX === 'undefined') {
     alert('XLSX 라이브러리 로드 실패');
     return false;
    }
    return true;
   }
   // --- 신규 라이브러리 체크 함수 ---
   function checkExcelJS() {
       if (typeof ExcelJS === 'undefined') {
           alert('ExcelJS 라이브러리 로드 실패');
           return false;
       }
       return true;
   }


   const fileInput  = document.getElementById('file-input');
   const fileNameEl = document.getElementById('file-name');
   const debitInput = document.getElementById('debit-label');
   const creditInput = document.getElementById('credit-label');
   const previewSec = document.getElementById('preview-section');
   const previewCont = document.getElementById('preview-container');
   const promptArea = document.getElementById('prompt-area');
   const promptText = document.getElementById('prompt-text');
   const editBtn    = document.getElementById('edit-btn');
   const downloadSec = document.getElementById('download-section');
   const downloadBtn = document.getElementById('download-btn');

   let workbook, selections = {}, step = 0, wizardActive = false, debitLabel, creditLabel;

   const prompts = [
    { key:'clientName', text:'1/7: 거래처명이 있는 셀을 선택하세요.', type:'cell' },
    { key:'headerRow',  text:'2/7: 제목 행을 선택하세요.',             type:'row'  },
    { key:'dateCol',    text:'3/7: \'일자\'가 있는 열을 선택하세요.',  type:'col'  },
    { key:'descCol',    text:'4/7: \'적요\'가 있는 열을 선택하세요.',  type:'col'  },
    { key:'debitCol',   text:'5/7: \'차변\'이 있는 열을 선택하세요.',  type:'col'  },
    { key:'creditCol',  text:'6/7: \'대변\'이 있는 열을 선택하세요.',  type:'col'  },
    { key:'balanceCol', text:'7/7: \'잔액\'이 있는 열을 선택하세요.',  type:'col'  }
   ];

   // getSheetData는 xlsx-js-style 라이브러리를 사용해 데이터를 읽어오는 기존 방식을 유지합니다.
   function getSheetData(ws, fillMerges = false) {
    if (!ws['!ref']) return [];
    const range = XLSX.utils.decode_range(ws['!ref']);
    const data = Array.from({ length: range.e.r + 1 }, () =>
     Array(range.e.c + 1).fill(null)
    );
    for (let addr in ws) {
     if (addr[0] === '!') continue;
     const { r, c } = XLSX.utils.decode_cell(addr);
     data[r][c] = ws[addr].w ?? ws[addr].v;
    }
    if (fillMerges && ws['!merges']) {
     ws['!merges'].forEach(m => {
      const v = data[m.s.r][m.s.c];
      for (let R = m.s.r; R <= m.e.r; R++)
       for (let C = m.s.c; C <= m.e.c; C++)
        data[R][C] = v;
     });
    }
    return data;
   }

   fileInput.addEventListener('change', e => {
    if (!checkXLSX()) return; // 파일 읽기는 기존 라이브러리 사용
    const file = e.target.files[0];
    if (!file) return;
    const reader = new FileReader();
    reader.onload = evt => {
     workbook = XLSX.read(new Uint8Array(evt.target.result), { type: 'array' });
     renderPreview(workbook.Sheets[workbook.SheetNames[0]]);
     fileNameEl.textContent = `선택됨: ${file.name}`;
     previewSec.classList.remove('hidden');
     editBtn.disabled = false;
    };
    reader.readAsArrayBuffer(file);
   });

   function renderPreview(ws) {
    const data = getSheetData(ws);
    let html = '<table class="preview-table">';
    data.slice(0, 30).forEach(row => { // 30행까지만 렌더링
     html += '<tr>';
     row.forEach(c => html += `<td>${c ?? ''}</td>`);
     html += '</tr>';
    });
    html += '</table>';
    previewCont.innerHTML = html;
    previewCont.querySelectorAll('td').forEach(td =>
     td.addEventListener('click', handleCellClick)
    );
   }

   editBtn.addEventListener('click', () => {
    const inquiryType = document.getElementById('inquiry-type-select').value;
    if (!inquiryType) {
        alert('문의 유형을 먼저 선택해주세요.');
        return;
    }
    debitLabel  = debitInput.value.trim()  || debitInput.placeholder;
    creditLabel = creditInput.value.trim() || creditInput.placeholder;
    wizardActive = true;
    step         = 0;
    selections   = {};
    editBtn.disabled  = true;
    editBtn.textContent = '선택 중...';
    promptArea.style.display = 'block';
    promptText.textContent   = prompts[0].text;
    previewCont.querySelectorAll('td').forEach(td =>
     td.classList.add('selectable')
    );
   });

   function handleCellClick(evt) {
    if (!wizardActive) return;
    const td = evt.currentTarget;
    const r  = td.parentElement.rowIndex;
    const c  = td.cellIndex;
    const p  = prompts[step];
    if (p.type === 'cell') {
     selections[p.key] = { row: r, col: c };
     td.classList.add('highlighted');
    } else if (p.type === 'row') {
     selections[p.key] = { row: r };
     td.parentElement.querySelectorAll('td').forEach(x => x.classList.add('highlighted'));
    } else {
     selections[p.key] = { col: c };
     previewCont.querySelectorAll('tr').forEach(tr => {
      const cell = tr.children[c];
      if (cell) cell.classList.add('highlighted');
     });
    }
    step++;
    if (step < prompts.length) {
     promptText.textContent = prompts[step].text;
    } else {
     wizardActive = false;
     promptArea.style.display = 'none';
     processWorkbook(); // 비동기 함수 호출
    }
   }
    
   // --- 최종 수정된 parseDateString 함수 ---
   // 타임존, 형식, 길이 등 모든 요청사항을 반영하여 날짜 파싱 로직을 수정했습니다.
   function parseDateString(dateStr) {
     if (!dateStr || typeof dateStr !== 'string') return null;

     const trimmedDateStr = dateStr.trim();

     // 요청사항 1: '~'가 포함된 날짜 범위이거나 길이가 10자를 초과하면 무시
     if (trimmedDateStr.includes('~') || trimmedDateStr.length > 10) {
       return null;
     }

     // 요청사항 2: 'YYYY-MM-DD' 또는 'YYYY.MM.DD' 형식 확인
     let match = trimmedDateStr.match(/^(\d{4})[-.](\d{1,2})[-.](\d{1,2})$/);
     if (match) {
       const year = parseInt(match[1], 10);
       const month = parseInt(match[2], 10);
       const day = parseInt(match[3], 10);
        // 날짜 유효성 검사
        if (month > 12 || month < 1 || day > 31 || day < 1) return null;
       // 타임존 문제를 방지하기 위해 UTC 기준으로 Date 객체 생성
       return new Date(Date.UTC(year, month - 1, day));
     }

     // 요청사항 3: 'MM-DD' 또는 'MM.DD' 형식 확인
     match = trimmedDateStr.match(/^(\d{1,2})[-.](\d{1,2})$/);
     if (match) {
       const currentYear = new Date().getFullYear();
       const month = parseInt(match[1], 10);
       const day = parseInt(match[2], 10);
        // 날짜 유효성 검사
        if (month > 12 || month < 1 || day > 31 || day < 1) return null;
       // 타임존 문제를 방지하기 위해 UTC 기준으로 Date 객체 생성
       return new Date(Date.UTC(currentYear, month - 1, day));
     }

     // 허용된 형식이 아니면 null 반환
     return null;
   }


    // --- processWorkbook 함수 ---
    async function processWorkbook() {
        if (!checkExcelJS()) return; // 새 라이브러리 체크
        
        const inquiryType = document.getElementById('inquiry-type-select').value;
        if (!inquiryType) { // 이중 체크
            alert('문의 유형이 선택되지 않았습니다.');
            editBtn.disabled = false;
            editBtn.textContent = '편집 시작';
            return;
        }

        const newWB = new ExcelJS.Workbook();

        workbook.SheetNames.forEach(sheetName => {
            const worksheet = newWB.addWorksheet(sheetName);
            const orig = workbook.Sheets[sheetName];
            const data = getSheetData(orig, true);
            const client = data[selections.clientName.row][selections.clientName.col];
            const startR = selections.headerRow.row + 1;

            // Step 1: 도움말 텍스트 준비
            const selVal = document.getElementById('option-select').value;
            const helpTextMapFormatted = {
                    "1": [
                        { text: '* 아래의 사항을 참고하셔서 입력 부탁드립니다.', type: 'header' }, { text: '외상대 잔액설명', type: 'header' },
                        { text: '- 잔액기준 플러스 금액: 세금계산서 발행보다 받은금액이 적은경우(은행 거래 내역 기준)', type: 'text' }, { text: '- 잔액기준 마이너스 금액: 세금계산서 발행보다 받은금액이 많은경우(세금계산서 미발행)', type: 'text' },
                        { text: '', type: 'text' }, { text: '기재참고사항', type: 'header' }, { text: '- 외상대 기입금 : 예) 1.15일 신한 015통장 입금', type: 'text' },
                        { text: '- 외상대와 상계 : 예) A거래처 외상매입금과 상계', type: 'text' }, { text: '- 월말잔액 : 예) 월말잔액 맞음', type: 'text' },
                        { text: '- 세금계산서 추후발행(잔액 마이너스) : 예) 12월 이후 발급예정', type: 'text' }, { text: '- 잔액상계 : 예) 대표 가수금처리', type: 'text' },
                        { text: '- 확인중: 확인 후 회신', type: 'text' }
                    ],
                    "2": [
                        { text: '* 아래의 사항을 참고하셔서 입력 부탁드립니다.', type: 'header' }, { text: '외상대 잔액설명', type: 'header' },
                        { text: '- 잔액 기준 플러스 금액: 통장에서 송금한 금액보다 세금계산서 수취가 많은 경우(외상대 미지급-통장기준)', type: 'text' }, { text: '- 잔액 기준 마이너스 금액: 통장에서 송금한 금액이 세금계산서 수취보다 많은 경우(증빙 미수취)', type: 'text' },
                        { text: '', type: 'text' }, { text: '기재참고사항', type: 'header' }, { text: '- 외상대 기인출: 예) 1.15일 신한 015통장 인출, 현금지급', type: 'text' },
                        { text: '- 외상대와 상계: 예) A거래처 외상매출금과 상계', type: 'text' }, { text: '- 월말잔액: 예) 월말잔액 맞음', type: 'text' },
                        { text: '- 세금계산서 추후수취: 예) 12월 이후 수취예정, 증빙첨부', type: 'text' }, { text: '- 잔액상계: 예) 대표 가지급금처리, 무증빙비용(가산세)', type: 'text' },
                        { text: '- 증빙첨부: 메일로 증빙을 첨부하여 회신', type: 'text' }, { text: '- 확인중: 확인 후 회신', type: 'text' }
                    ],
                    "3": [
                        { text: '* 아래의 사항을 참고하셔서 입력 부탁드립니다.', type: 'header' }, { text: '기재참고사항', type: 'header' },
                        { text: '- 세금계산서 기수취: 예) 1.15일 ABC상회 매입세금계산서 수취', type: 'text' }, { text: '- 세금계산서 기발행: 예) 1.15일 ABC상회 매출세금계산서 발급', type: 'text' },
                        { text: '- 세금계산서 추후수취: 예) 7월에 ABC상회 수취예정', type: 'text' }, { text: '- 세금계산서 추후발행: 예) 7월에 ABC상회 발급예정', type: 'text' },
                        { text: '- 증빙첨부: 증빙 첨부 회신', type: 'text' }, { text: '- 인건비: 예) 일용직/근로자/기타소득/신고예정', type: 'text' },
                        { text: '- 잔액상계: 예) 대표 가지급금처리, 비용처리 요망', type: 'text' }, { text: '- 확인중: 확인 후 회신', type: 'text' }
                    ]
                };
            const helpContent = helpTextMapFormatted[selVal] || [];
            const helpRowCount = helpContent.length;

            // Step 2: 스타일 정의 (ExcelJS 형식)
            const clientNameStyle = { font: { name: 'Inter', bold: true, size: 14, color: { argb: "FFFFFFFF" } }, fill: { type: 'pattern', pattern: 'solid', fgColor: { argb: 'FF2C5599' } }, alignment: { horizontal: 'center', vertical: 'center' } };
            const headerStyle = { font: { name: 'Inter', bold: true, color: { argb: 'FFFFFFFF' } }, fill: { type: 'pattern', pattern: 'solid', fgColor: { argb: 'FF4F81BD' } }, alignment: { horizontal: 'center' } };
            const inputAreaStyle = { fill: { type: 'pattern', pattern: 'solid', fgColor: { argb: 'FFFFF2CC' } } };
            const monthColors = [ null, { type: 'pattern', pattern: 'solid', fgColor: { argb: 'FFF2F2F2' } } ];
            const helpHeaderStyle = { font: { name:'Inter', bold:true, size:11, color:{ argb:'FF1F4E79' } }, fill: { type:'pattern', pattern:'solid', fgColor:{ argb:'FFDDEBF7' } }, alignment:{ wrapText:true, vertical:'top', horizontal:'left' } };
            const helpTextStyle = { font: { name:'Inter', bold:false, size:10, color:{ argb:'FF333333' } }, fill: { type:'pattern', pattern:'solid', fgColor:{ argb:'FFDDEBF7' } }, alignment:{ wrapText:true, vertical:'top', horizontal:'left' } };

            // Step 3: 데이터 행 추가 및 스타일링
            helpContent.forEach(item => {
                const row = worksheet.addRow([item.text]);
                worksheet.mergeCells(row.number, 1, row.number, 7);
                row.getCell(1).style = (item.type === 'header') ? helpHeaderStyle : helpTextStyle;
            });

            const clientRow = worksheet.addRow([client]);
            worksheet.mergeCells(clientRow.number, 1, clientRow.number, 7);
            clientRow.getCell(1).style = clientNameStyle;

            const headerRow = worksheet.addRow(['일자', debitLabel, creditLabel, '외상대 잔액', '세금계산서 및 통장 적요', '담당자 문의사항', '업체 답변기재']);
            headerRow.eachCell(cell => cell.style = headerStyle);
            const headerRowNumber = headerRow.number;

            let lastMonth = -1, colorIndex = 0;
            const firstDataRowNumber = worksheet.rowCount + 1;
            for (let i = startR; i < data.length; i++) {
                const rowData = data[i];
                if (!rowData) continue;
                const dv = rowData[selections.dateCol.col], bv = rowData[selections.balanceCol.col];
                if (!((dv || '').toString().trim() || (bv || '').toString().trim())) continue;
                
                // --- 수정된 부분 ---
                // 1. 한글/영어가 포함된 행 무시
                if (typeof dv === 'string' && /[가-힣A-Za-z]/.test(dv)) continue;
                // 2. 10자가 넘는 문자열 행 무시 (예: '2025.01.01 ~ ...')
                if (typeof dv === 'string' && dv.trim().length > 10) continue;

                const desc = rowData[selections.descCol.col];
                const dr = parseFloat((rowData[selections.debitCol.col] || '').toString().replace(/,/g, '')) || 0;
                const cr = parseFloat((rowData[selections.creditCol.col] || '').toString().replace(/,/g, '')) || 0;
                
                // --- 수정된 부분 ---
                // 원본 데이터 형식을 그대로 유지하기 위해 날짜 변환 로직을 제거하고, 원본 값을 그대로 사용합니다.
                let fd = dv;
                
                // 월별 색상 구분을 위해 날짜를 파싱하되, 결과는 색상에만 사용합니다.
                let parsedDate = null;
                if (orig[XLSX.utils.encode_cell({ r: i, c: selections.dateCol.col })]?.t === 'n') {
                    const jd = XLSX.SSF.parse_date_code(orig[XLSX.utils.encode_cell({ r: i, c: selections.dateCol.col })].v);
                    if (jd) parsedDate = new Date(Date.UTC(jd.y, jd.m - 1, jd.d));
                } else if (typeof dv === 'string') {
                    parsedDate = parseDateString(dv);
                }
                
                const dataRow = worksheet.addRow([fd, dr, cr, null, desc, '', '']);

                let currentFill = null;
                if (parsedDate instanceof Date) {
                    const month = parsedDate.getUTCMonth(); // UTC 기준으로 월을 가져옴
                    if (lastMonth !== -1 && month !== lastMonth) colorIndex = (colorIndex + 1) % monthColors.length;
                    lastMonth = month;
                    currentFill = monthColors[colorIndex];
                } else {
                    currentFill = monthColors[colorIndex];
                }

                dataRow.eachCell({ includeEmpty: true }, (cell, colNumber) => {
                    if (currentFill) cell.fill = currentFill;
                    // --- 수정된 부분 ---
                    // 날짜를 텍스트로 저장하므로, 특정 숫자 형식('mm-dd')을 적용하는 코드를 제거합니다.
                    if (colNumber >= 2 && colNumber <= 4) {
                        cell.numFmt = '#,##0';
                        cell.alignment = { horizontal: 'right' };
                    }
                    if (colNumber === 6 || colNumber === 7) cell.fill = inputAreaStyle.fill;
                });
                
                // --- 잔액 공식 조건부 적용 ---
                const balanceCell = dataRow.getCell(4);
                const rowNum = dataRow.number;
                if (inquiryType === '매입처') {
                    if (rowNum === firstDataRowNumber) {
                        balanceCell.value = { formula: `C${rowNum}-B${rowNum}` };
                    } else {
                        balanceCell.value = { formula: `D${rowNum - 1}+C${rowNum}-B${rowNum}` };
                    }
                } else { // 매출처 또는 확인사항
                    if (rowNum === firstDataRowNumber) {
                        balanceCell.value = { formula: `B${rowNum}-C${rowNum}` };
                    } else {
                        balanceCell.value = { formula: `D${rowNum - 1}+B${rowNum}-C${rowNum}` };
                    }
                }
            }
            
            worksheet.columns = [
                { width: 12 }, { width: 25 }, { width: 25 }, { width: 25 },
                { width: 45 }, { width: 35 }, { width: 35 }
            ];

            worksheet.views = [{
                state: 'frozen',
                ySplit: headerRowNumber,
                topLeftCell: `A${headerRowNumber + 1}`
            }];
        });

        const buf = await newWB.xlsx.writeBuffer();
        const blob = new Blob([buf], { type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' });
        if (downloadBtn.href.startsWith('blob:')) URL.revokeObjectURL(downloadBtn.href);
        downloadBtn.href = URL.createObjectURL(blob);
        downloadBtn.download = 'ilsintax.xlsx';
        downloadSec.classList.remove('hidden');
        previewSec.classList.add('hidden');
        editBtn.textContent = '편집 시작';
        editBtn.disabled = false;
    }


   const optionDetails = {
    none: '기재하지 않습니다.',
    1: `
외상대 잔액설명
- 잔액기준 플러스 금액: 세금계산서 발행보다 받은금액이 적은경우(은행 거래 내역 기준)
- 잔액기준 마이너스 금액: 세금계산서 발행보다 받은금액이 많은경우(세금계산서 미발행)

기재참고사항
- 외상대 기입금 : 예) 1.15일 신한 015통장 입금
- 외상대와 상계 : 예) A거래처 외상매입금과 상계
- 월말잔액 : 예) 월말잔액 맞음
- 세금계산서 추후발행(잔액 마이너스) : 예) 12월 이후 발급예정
- 잔액상계 : 예) 대표 가수금처리
- 확인중: 확인 후 회신
`.trim(),
    2: `
외상대 잔액설명
- 잔액 기준 플러스 금액: 통장에서 송금한 금액보다 세금계산서 수취가 많은 경우(외상대 미지급-통장기준)
- 잔액 기준 마이너스 금액: 통장에서 송금한 금액이 세금계산서 수취보다 많은 경우(증빙 미수취)

기재참고사항
- 외상대 기인출: 예) 1.15일 신한 015통장 인출, 현금지급
- 외상대와 상계: 예) A거래처 외상매출금과 상계
- 월말잔액: 예) 월말잔액 맞음
- 세금계산서 추후수취: 예) 12월 이후 수취예정, 증빙첨부
- 잔액상계: 예) 대표 가지급금처리, 무증빙비용(가산세)
- 증빙첨부: 메일로 증빙을 첨부하여 회신
- 확인중: 확인 후 회신
`.trim(),
    3: `
기재참고사항
- 세금계산서 기수취: 예) 1.15일 ABC상회 매입세금계산서 수취
- 세금계산서 기발행: 예) 1.15일 ABC상회 매출세금계산서 발급
- 세금계산서 추후수취: 예) 7월에 ABC상회 수취예정
- 세금계산서 추후발행: 예) 7월에 ABC상회 발급예정
- 증빙첨부: 증빙 첨부 회신
- 인건비: 예) 일용직/근로자/기타소득/신고예정
- 잔액상계: 예) 대표 가지급금처리, 비용처리 요망
- 확인중: 확인 후 회신
`.trim()
   };
   const selectEl = document.getElementById('option-select');
   const detailEl = document.getElementById('option-detail');
   selectEl.addEventListener('change', () => {
    const text = optionDetails[selectEl.value] || '';
    detailEl.innerHTML = text.replace(/\n/g, '<br>');
    detailEl.classList.toggle('hidden', !text);
   });

   window.addEventListener('load', () => {
       setTimeout(() => {
           checkXLSX();
           checkExcelJS();
       }, 1000);
   });
  </script>
 </body>
 </html>

